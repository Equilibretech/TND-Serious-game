<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parcours TND - Les Cl√©s de l'Inclusion</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #4caf50;
            --error-color: #f44336;
            --warning-color: #ff9800;
            --info-color: #2196f3;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* √âcran d'accueil */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            color: white;
        }

        .welcome-screen h1 {
            font-size: 3em;
            margin-bottom: 20px;
            animation: fadeIn 1s ease-in;
        }

        .welcome-screen p {
            font-size: 1.3em;
            margin-bottom: 40px;
            opacity: 0.9;
            animation: fadeIn 1.5s ease-in;
        }

        .button-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            animation: fadeIn 2s ease-in;
        }

        .start-btn, .secondary-btn {
            background: white;
            color: var(--primary-color);
            padding: 15px 40px;
            font-size: 1.2em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .secondary-btn {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .start-btn:hover, .secondary-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .secondary-btn:hover {
            background: white;
            color: var(--primary-color);
        }

        /* Navigation */
        .navbar {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: none;
        }

        .nav-items {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .player-level {
            background: var(--secondary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .score {
            background: var(--primary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            transition: transform 0.3s;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            background: #e0e0e0;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }

        .nav-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .badges {
            display: flex;
            gap: 10px;
        }

        .badge {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }

        .badge.unlocked {
            background: gold;
            animation: bounce 0.5s;
        }

        .badge-tooltip {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8em;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 10;
        }

        .badge:hover .badge-tooltip {
            opacity: 1;
        }

        /* Modules */
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            display: none;
        }

        .module-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .module-card:hover:not(.disabled) {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .module-card.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .module-card.completed {
            border: 3px solid var(--success-color);
        }

        .module-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .module-card h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .module-card p {
            color: #666;
            font-size: 0.9em;
        }

        .coming-soon {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--error-color);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
        }

        .completed-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--success-color);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: #e0e0e0;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-color);
            width: 0%;
            transition: width 0.5s;
        }

        /* Dashboard */
        .dashboard {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        .achievements-list {
            margin-top: 30px;
        }

        .achievement {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
        }

        .achievement:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .achievement-icon {
            font-size: 2em;
        }

        .achievement-info h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .achievement-info p {
            color: #666;
            font-size: 0.9em;
        }

        /* Jeu Maison */
        .house-game {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            position: relative;
        }

        .house-3d {
            perspective: 1000px;
            margin: 20px auto;
            max-width: 800px;
        }

        .room-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .room {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            transform-style: preserve-3d;
        }

        .room:hover {
            background: #e8eaf6;
            transform: scale(1.05) rotateY(5deg);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .room.visited {
            border: 3px solid var(--success-color);
        }

        .room-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .room h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .room p {
            font-size: 0.9em;
            color: #666;
        }

        .room-info {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--error-color);
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8em;
            animation: pulse 2s infinite;
        }

        /* Mini-jeu adaptation */
        .adaptation-game {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .scenario-counter {
            color: var(--primary-color);
            font-weight: bold;
        }

        .scenario-progress-bar {
            background: #e0e0e0;
            height: 10px;
            width: 200px;
            border-radius: 5px;
            overflow: hidden;
        }

        .scenario-progress-fill {
            background: var(--success-color);
            height: 100%;
            width: 20%;
            transition: width 0.5s;
        }

        .timer {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #666;
        }

        .scenario-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            animation: slideIn 0.5s ease-out;
            position: relative;
        }

        .scenario-character {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .character-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }

        .character-info h4 {
            color: var(--primary-color);
            margin-bottom: 3px;
        }

        .character-info p {
            font-size: 0.9em;
            color: #666;
        }

        .choices {
            display: grid;
            gap: 10px;
            margin-top: 20px;
        }

        .choice {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .choice::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: rgba(102, 126, 234, 0.1);
            transition: width 0.3s;
        }

        .choice:hover:not(.disabled)::before {
            width: 100%;
        }

        .choice:hover:not(.disabled) {
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        .choice.disabled {
            cursor: default;
            opacity: 0.8;
        }

        .choice.correct {
            border-color: var(--success-color);
            background: #e8f5e9;
        }

        .choice.incorrect {
            border-color: var(--error-color);
            background: #ffebee;
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
            animation: fadeIn 0.5s;
        }

        .feedback.success {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .feedback.error {
            background: #ffebee;
            color: #c62828;
        }

        /* Jeu Caf√© des Parents */
        .cafe-game {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .conversation-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .conversation-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }

        .conversation-box::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 30px;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 10px solid #f8f9fa;
        }

        .speaker {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .speaker-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .speaker-name {
            font-weight: bold;
            color: var(--primary-color);
        }

        .response-options {
            display: grid;
            gap: 10px;
            margin-top: 20px;
        }

        /* Atelier des Solutions */
        .workshop-game {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .tool-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            text-align: center;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            background: #e8eaf6;
        }

        .tool-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .tool-card h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .tool-card p {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .tool-category {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--info-color);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8em;
        }

        .tool-details {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
            text-align: left;
        }

        .tool-details ul {
            list-style: none;
            padding: 0;
        }

        .tool-details li {
            padding: 5px 0;
            color: #666;
            font-size: 0.9em;
        }

        .tool-details li:before {
            content: '‚úì ';
            color: var(--success-color);
            font-weight: bold;
        }

        /* Quiz rapide */
        .quick-quiz {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .quiz-timer {
            font-size: 2em;
            color: var(--primary-color);
            font-weight: bold;
        }

        .quiz-question {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .quiz-question h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .quiz-option {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: var(--primary-color);
            transform: scale(1.05);
        }

        .quiz-results {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .quiz-score {
            font-size: 3em;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        /* Ressources */
        .resources {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
        }

        .resources-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            background: #e0e0e0;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: var(--primary-color);
            color: white;
        }

        .resources-content {
            display: grid;
            gap: 15px;
        }

        .resource-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .resource-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .resource-info h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .resource-info p {
            color: #666;
            font-size: 0.9em;
        }

        .download-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .download-btn:hover {
            background: var(--secondary-color);
            transform: scale(1.1);
        }

        /* Popup d'information */
        .info-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1000;
            animation: popIn 0.3s;
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .popup-header h3 {
            color: var(--primary-color);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
        }

        .close-btn:hover {
            color: #333;
        }

        .popup-content {
            line-height: 1.6;
        }

        .popup-content ul {
            margin: 15px 0;
            padding-left: 20px;
        }

        .popup-content li {
            margin: 10px 0;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #5a5fcf;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        /* Notification Toast */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 2000;
            animation: slideInRight 0.5s;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 350px;
        }

        .notification.success {
            border-left: 4px solid var(--success-color);
        }

        .notification.info {
            border-left: 4px solid var(--info-color);
        }

        .notification.warning {
            border-left: 4px solid var(--warning-color);
        }

        /* Overlay */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes popIn {
            from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-screen h1 { font-size: 2em; }
            .room-container { grid-template-columns: 1fr; }
            .nav-items { flex-direction: column; gap: 15px; }
            .quiz-options { grid-template-columns: 1fr; }
            .tools-grid { grid-template-columns: 1fr; }
        }

        /* Mode sombre */
        .dark-mode {
            background: #1a1a1a;
            color: white;
        }

        .dark-mode .navbar,
        .dark-mode .module-card,
        .dark-mode .house-game,
        .dark-mode .adaptation-game,
        .dark-mode .cafe-game,
        .dark-mode .workshop-game,
        .dark-mode .dashboard,
        .dark-mode .resources,
        .dark-mode .quick-quiz,
        .dark-mode .info-popup {
            background: #2a2a2a;
            color: white;
        }

        .dark-mode .room,
        .dark-mode .stat-card,
        .dark-mode .scenario-box,
        .dark-mode .conversation-box,
        .dark-mode .tool-card,
        .dark-mode .achievement,
        .dark-mode .resource-item {
            background: #3a3a3a;
        }

        .dark-mode .choice,
        .dark-mode .quiz-option {
            background: #3a3a3a;
            border-color: #4a4a4a;
        }

        .dark-mode .btn-secondary,
        .dark-mode .nav-btn,
        .dark-mode .tab {
            background: #4a4a4a;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- √âcran d'accueil -->
        <div class="welcome-screen" id="welcomeScreen">
            <h1>üéÆ Parcours TND</h1>
            <p>Les Cl√©s de l'Inclusion</p>
            <p style="font-size: 1em; max-width: 600px;">
                D√©couvrez les Troubles du Neurod√©veloppement √† travers une exp√©rience 
                interactive et bienveillante. D√©veloppez vos comp√©tences d'accompagnement 
                et devenez acteur de l'inclusion !
            </p>
            <div class="button-group">
                <button class="start-btn" onclick="startGame()">Commencer l'aventure</button>
                <button class="secondary-btn" onclick="showQuickQuiz()">Quiz rapide</button>
            </div>
            
            <!-- Bouton cach√© pour les infos de d√©veloppement (coin inf√©rieur droit) -->
            <div style="position: fixed; bottom: 10px; right: 10px; width: 50px; height: 50px; cursor: pointer;" onclick="showDevInfo()" title="Zone secr√®te"></div>
        </div>

        <!-- Barre de navigation -->
        <nav class="navbar" id="navbar">
            <div class="nav-items">
                <div class="player-info">
                    <h3>Bienvenue, Formateur¬∑rice !</h3>
                    <div class="player-level">
                        <span>Niveau <span id="playerLevel">1</span></span>
                        <span style="font-size: 0.8em;">‚≠ê</span>
                    </div>
                    <div class="score">Score: <span id="score">0</span> XP</div>
                </div>
                <div class="nav-buttons">
                    <button class="nav-btn" onclick="showDashboard()">üìä Tableau de bord</button>
                    <button class="nav-btn" onclick="showResources()">üìö Ressources</button>
                    <button class="nav-btn" onclick="toggleDarkMode()">üåô</button>
                </div>
                <div class="badges">
                    <div class="badge" id="badge1">
                        üåü
                        <span class="badge-tooltip">Observateur attentif</span>
                    </div>
                    <div class="badge" id="badge2">
                        ü§ù
                        <span class="badge-tooltip">M√©diateur bienveillant</span>
                    </div>
                    <div class="badge" id="badge3">
                        üõ†Ô∏è
                        <span class="badge-tooltip">Architecte de l'inclusion</span>
                    </div>
                    <div class="badge" id="badge4">
                        üí°
                        <span class="badge-tooltip">Innovateur p√©dagogique</span>
                    </div>
                    <div class="badge" id="badge5">
                        üéØ
                        <span class="badge-tooltip">Expert en inclusion</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Grille des modules -->
        <div class="module-grid" id="moduleGrid">
            <div class="module-card" onclick="openHouseGame()">
                <div class="module-icon">üè†</div>
                <h3>La Maison des D√©couvertes</h3>
                <p>Explorez les diff√©rents TND √† travers une maison interactive</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="houseProgress"></div>
                </div>
            </div>
            
            <div class="module-card" onclick="openAdaptationGame()">
                <div class="module-icon">üéí</div>
                <h3>L'√âcole Inclusive</h3>
                <p>Apprenez √† adapter votre classe pour tous les √©l√®ves</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="schoolProgress"></div>
                </div>
            </div>
            
            <div class="module-card" onclick="openCafeGame()">
                <div class="module-icon">‚òï</div>
                <h3>Le Caf√© des Parents</h3>
                <p>√âchangez et d√©construisez les pr√©jug√©s</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="cafeProgress"></div>
                </div>
            </div>
            
            <div class="module-card" onclick="openWorkshop()">
                <div class="module-icon">üõ†Ô∏è</div>
                <h3>L'Atelier des Solutions</h3>
                <p>D√©couvrez votre bo√Æte √† outils inclusive</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="workshopProgress"></div>
                </div>
            </div>
        </div>

        <!-- Tableau de bord -->
        <div class="dashboard" id="dashboard">
            <h2>üìä Tableau de bord</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalScore">0</div>
                    <div class="stat-label">Points XP</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="modulesCompleted">0/4</div>
                    <div class="stat-label">Modules compl√©t√©s</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="badgesUnlocked">0/5</div>
                    <div class="stat-label">Badges d√©bloqu√©s</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="timeSpent">0h</div>
                    <div class="stat-label">Temps de jeu</div>
                </div>
            </div>

            <div class="achievements-list">
                <h3>üèÜ Accomplissements</h3>
                <div id="achievementsList"></div>
            </div>

            <button class="btn btn-secondary" onclick="backToModules()" style="margin-top: 20px;">
                Retour aux modules
            </button>
        </div>

        <!-- Jeu Maison des D√©couvertes -->
        <div class="house-game" id="houseGame">
            <h2>üè† La Maison des D√©couvertes</h2>
            <p>Chaque pi√®ce repr√©sente un trouble du neurod√©veloppement. Cliquez pour explorer !</p>
            
            <div class="house-3d">
                <div class="room-container">
                    <div class="room" id="room-tsa" onclick="showRoomInfo('tsa')">
                        <div class="room-icon">üõãÔ∏è</div>
                        <h4>Salon</h4>
                        <p>TSA</p>
                        <span class="room-info" id="info-tsa">!</span>
                    </div>
                    
                    <div class="room" id="room-tdah" onclick="showRoomInfo('tdah')">
                        <div class="room-icon">üç≥</div>
                        <h4>Cuisine</h4>
                        <p>TDAH</p>
                        <span class="room-info" id="info-tdah">!</span>
                    </div>
                    
                    <div class="room" id="room-dys" onclick="showRoomInfo('dys')">
                        <div class="room-icon">üìö</div>
                        <h4>Bureau</h4>
                        <p>Troubles DYS</p>
                        <span class="room-info" id="info-dys">!</span>
                    </div>
                    
                    <div class="room" id="room-di" onclick="showRoomInfo('di')">
                        <div class="room-icon">üõèÔ∏è</div>
                        <h4>Chambre</h4>
                        <p>D√©ficience intellectuelle</p>
                        <span class="room-info" id="info-di">!</span>
                    </div>
                    
                    <div class="room" id="room-moteur" onclick="showRoomInfo('moteur')">
                        <div class="room-icon">üå≥</div>
                        <h4>Jardin</h4>
                        <p>Troubles moteurs</p>
                        <span class="room-info" id="info-moteur">!</span>
                    </div>

                    <div class="room" id="room-communication" onclick="showRoomInfo('communication')">
                        <div class="room-icon">üí¨</div>
                        <h4>Salle de jeux</h4>
                        <p>Troubles de la communication</p>
                        <span class="room-info" id="info-communication">!</span>
                    </div>
                </div>
            </div>
            
            <button class="btn btn-secondary" onclick="backToModules()" style="margin-top: 20px;">
                Retour aux modules
            </button>
        </div>

        <!-- Mini-jeu adaptation -->
        <div class="adaptation-game" id="adaptationGame">
            <h2>üéí L'√âcole Inclusive - Sc√©narios d'adaptation</h2>
            
            <div class="scenario-header">
                <div class="scenario-counter">Sc√©nario <span id="currentScenario">1</span>/5</div>
                <div class="scenario-progress-bar">
                    <div class="scenario-progress-fill" id="scenarioProgress"></div>
                </div>
                <div class="timer">
                    <span>‚è±Ô∏è</span>
                    <span id="scenarioTimer">--:--</span>
                </div>
            </div>
            
            <div class="scenario-box" id="scenarioBox">
                <div class="scenario-character">
                    <div class="character-avatar">üëß</div>
                    <div class="character-info">
                        <h4 id="characterName">Emma</h4>
                        <p id="characterAge">8 ans</p>
                    </div>
                </div>
                <h3>Situation :</h3>
                <p id="scenarioText"></p>
            </div>
            
            <div class="choices" id="choicesContainer"></div>
            
            <div class="feedback" id="feedback"></div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-primary" id="nextScenarioBtn" onclick="nextScenario()" style="display: none;">
                    Sc√©nario suivant ‚Üí
                </button>
                <button class="btn btn-secondary" onclick="backToModules()">
                    Retour aux modules
                </button>
            </div>
        </div>

        <!-- Jeu Caf√© des Parents -->
        <div class="cafe-game" id="cafeGame">
            <h2>‚òï Le Caf√© des Parents</h2>
            <p>Participez √† des conversations constructives pour d√©construire les pr√©jug√©s</p>
            
            <div class="conversation-container" id="conversationContainer">
                <div class="conversation-box">
                    <div class="speaker">
                        <div class="speaker-avatar">üë§</div>
                        <div class="speaker-name" id="speakerName">Parent inquiet</div>
                    </div>
                    <p id="parentQuestion">"Mon enfant va avoir un √©l√®ve autiste dans sa classe. J'ai peur que cela perturbe son apprentissage..."</p>
                </div>
                
                <div class="response-options" id="responseOptions"></div>
            </div>
            
            <div class="feedback" id="cafeFeedback"></div>
            
            <button class="btn btn-secondary" onclick="backToModules()" style="margin-top: 20px;">
                Retour aux modules
            </button>
        </div>

        <!-- Atelier des Solutions -->
        <div class="workshop-game" id="workshopGame">
            <h2>üõ†Ô∏è L'Atelier des Solutions</h2>
            <p>Explorez votre bo√Æte √† outils pour cr√©er un environnement inclusif</p>
            
            <div class="tools-grid" id="toolsGrid">
                <div class="tool-card" onclick="toggleToolDetails(this)">
                    <span class="tool-category">Sensoriel</span>
                    <div class="tool-icon">üéß</div>
                    <h4>Casque anti-bruit</h4>
                    <p>R√©duit les stimuli sonores pour les √©l√®ves hypersensibles</p>
                    <div class="tool-details">
                        <ul>
                            <li>Id√©al pour les √©l√®ves avec TSA ou TDAH</li>
                            <li>Permet la concentration dans un environnement bruyant</li>
                            <li>Disponible en diff√©rentes tailles et couleurs</li>
                        </ul>
                    </div>
                </div>

                <div class="tool-card" onclick="toggleToolDetails(this)">
                    <span class="tool-category">Organisation</span>
                    <div class="tool-icon">‚è∞</div>
                    <h4>Time Timer</h4>
                    <p>Visualisation du temps qui passe pour structurer les activit√©s</p>
                    <div class="tool-details">
                        <ul>
                            <li>Repr√©sentation visuelle du temps restant</li>
                            <li>Aide √† la gestion du temps et des transitions</li>
                            <li>R√©duit l'anxi√©t√© li√©e au temps</li>
                        </ul>
                    </div>
                </div>

                <div class="tool-card" onclick="toggleToolDetails(this)">
                    <span class="tool-category">Motricit√©</span>
                    <div class="tool-icon">ü™ë</div>
                    <h4>Coussin d'√©quilibre</h4>
                    <p>Permet le mouvement tout en restant assis</p>
                    <div class="tool-details">
                        <ul>
                            <li>Favorise la concentration pour les √©l√®ves TDAH</li>
                            <li>Am√©liore la posture et l'√©quilibre</li>
                            <li>Stimulation proprioceptive douce</li>
                        </ul>
                    </div>
                </div>

                <div class="tool-card" onclick="toggleToolDetails(this)">
                    <span class="tool-category">Communication</span>
                    <div class="tool-icon">üñºÔ∏è</div>
                    <h4>Pictogrammes</h4>
                    <p>Support visuel pour la communication et l'organisation</p>
                    <div class="tool-details">
                        <ul>
                            <li>Facilite la compr√©hension des consignes</li>
                            <li>Aide √† structurer la journ√©e</li>
                            <li>Support pour les √©l√®ves non-verbaux</li>
                        </ul>
                    </div>
                </div>
            </div>

            <button class="btn btn-secondary" onclick="backToModules()" style="margin-top: 20px;">
                Retour aux modules
            </button>
        </div>

        <!-- Ressources -->
        <div class="resources" id="resources">
            <h2>üìö Centre de Ressources</h2>
            
            <div class="resources-tabs">
                <button class="tab active" onclick="showResourceTab('guides')">Guides</button>
                <button class="tab" onclick="showResourceTab('videos')">Vid√©os</button>
                <button class="tab" onclick="showResourceTab('outils')">Outils</button>
                <button class="tab" onclick="showResourceTab('liens')">Liens utiles</button>
            </div>

            <div class="resources-content" id="resourcesContent">
                <div class="resource-item">
                    <div class="resource-info">
                        <h4>Guide de l'inclusion scolaire</h4>
                        <p>Document complet sur les adaptations p√©dagogiques</p>
                    </div>
                    <button class="download-btn" onclick="downloadResource('guide-inclusion')">
                        üì• T√©l√©charger
                    </button>
                </div>
                
                <div class="resource-item">
                    <div class="resource-info">
                        <h4>Fiches pratiques TSA</h4>
                        <p>10 fiches d'adaptation pour les √©l√®ves avec TSA</p>
                    </div>
                    <button class="download-btn" onclick="downloadResource('fiches-tsa')">
                        üì• T√©l√©charger
                    </button>
                </div>
                
                <div class="resource-item">
                    <div class="resource-info">
                        <h4>Bo√Æte √† outils TDAH</h4>
                        <p>Strat√©gies et outils pour accompagner les √©l√®ves TDAH</p>
                    </div>
                    <button class="download-btn" onclick="downloadResource('outils-tdah')">
                        üì• T√©l√©charger
                    </button>
                </div>
            </div>

            <button class="btn btn-secondary" onclick="backToModules()" style="margin-top: 20px;">
                Retour aux modules
            </button>
        </div>

        <!-- Quiz rapide -->
        <div class="quick-quiz" id="quickQuiz">
            <div class="quiz-header">
                <h2>‚ö° Quiz Rapide TND</h2>
                <div class="quiz-timer" id="quizTimer">30</div>
            </div>

            <div class="quiz-question" id="quizQuestion">
                <h3 id="questionText">Quel trouble se caract√©rise par des difficult√©s de coordination motrice ?</h3>
                <div class="quiz-options" id="quizOptions">
                    <div class="quiz-option" onclick="checkQuizAnswer(this, false)">TDAH</div>
                    <div class="quiz-option" onclick="checkQuizAnswer(this, true)">Dyspraxie</div>
                    <div class="quiz-option" onclick="checkQuizAnswer(this, false)">Dyslexie</div>
                    <div class="quiz-option" onclick="checkQuizAnswer(this, false)">TSA</div>
                </div>
            </div>

            <div class="quiz-results" id="quizResults">
                <h2>R√©sultats du Quiz</h2>
                <div class="quiz-score" id="quizScore">0/10</div>
                <p id="quizMessage"></p>
                <button class="btn btn-primary" onclick="restartQuiz()">Rejouer</button>
                <button class="btn btn-secondary" onclick="startGame()">Retour au jeu</button>
            </div>
        </div>
    </div>

    <!-- Popup d'information -->
    <div class="overlay" id="overlay" onclick="closePopup()"></div>
    <div class="info-popup" id="infoPopup">
        <div class="popup-header">
            <h3 id="popupTitle"></h3>
            <button class="close-btn" onclick="closePopup()">√ó</button>
        </div>
        <div class="popup-content" id="popupContent"></div>
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="completeRoom()">J'ai compris !</button>
            <button class="btn btn-secondary" onclick="closePopup()">Fermer</button>
        </div>
    </div>

    <script>
        // Variables globales
        let score = 0;
        let level = 1;
        let roomsVisited = [];
        let currentRoom = '';
        let unlockedBadges = [];
        let currentScenarioIndex = 0;
        let scenariosCompleted = 0;
        let correctAnswersCount = 0;
        let answeredCurrentQuestion = false;
        let cafeScenarioIndex = 0;
        let quizCurrentQuestion = 0;
        let quizScore = 0;
        let quizTimer = null;
        let gameStartTime = Date.now();
        let completedModules = [];
        let toolsDiscovered = [];

        // Sauvegarde locale
        function saveProgress() {
            const gameData = {
                score,
                level,
                roomsVisited,
                unlockedBadges,
                completedModules,
                toolsDiscovered,
                gameStartTime
            };
            localStorage.setItem('tndGameProgress', JSON.stringify(gameData));
        }

        function loadProgress() {
            const savedData = localStorage.getItem('tndGameProgress');
            if (savedData) {
                const data = JSON.parse(savedData);
                score = data.score || 0;
                level = data.level || 1;
                roomsVisited = data.roomsVisited || [];
                unlockedBadges = data.unlockedBadges || [];
                completedModules = data.completedModules || [];
                toolsDiscovered = data.toolsDiscovered || [];
                gameStartTime = data.gameStartTime || Date.now();
                
                // Mettre √† jour l'interface
                updateUI();
            }
        }

        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('playerLevel').textContent = level;
            
            // Mettre √† jour les badges
            unlockedBadges.forEach(badgeId => {
                document.getElementById(badgeId).classList.add('unlocked');
            });
            
            // Mettre √† jour les progressions
            if (roomsVisited.length > 0) {
                document.getElementById('houseProgress').style.width = (roomsVisited.length / 6 * 100) + '%';
            }
            
            // Marquer les modules compl√©t√©s
            completedModules.forEach(module => {
                const moduleCard = document.querySelector(`[onclick*="${module}"]`);
                if (moduleCard && moduleCard.classList.contains('module-card')) {
                    moduleCard.classList.add('completed');
                    if (!moduleCard.querySelector('.completed-badge')) {
                        const badge = document.createElement('span');
                        badge.className = 'completed-badge';
                        badge.textContent = '‚úì';
                        moduleCard.appendChild(badge);
                    }
                }
            });
        }

        // Sc√©narios du module √âcole Inclusive
        const scenarios = [
            {
                name: "Emma",
                age: "8 ans",
                avatar: "üëß",
                situation: "Emma, 8 ans, est dyslexique. Elle doit lire un texte devant la classe. Comment adaptez-vous cette activit√© pour qu'elle puisse participer sereinement ?",
                choices: [
                    {
                        text: "Lui demander de lire comme les autres √©l√®ves, cela l'aidera √† progresser",
                        correct: false,
                        feedback: "Cette approche risque de mettre Emma en difficult√© et de cr√©er de l'anxi√©t√©."
                    },
                    {
                        text: "Lui fournir le texte √† l'avance avec une police adapt√©e (Arial 14) et un interligne augment√©",
                        correct: true,
                        feedback: "Excellent ! Cette adaptation permet √† Emma de se pr√©parer et facilite sa lecture."
                    },
                    {
                        text: "L'exempter de l'exercice pour lui √©viter du stress",
                        correct: false,
                        feedback: "L'exclusion n'est pas une solution. Il faut adapter, non exclure."
                    },
                    {
                        text: "Proposer une lecture en bin√¥me avec un camarade volontaire qui peut l'aider si besoin",
                        correct: true,
                        feedback: "Tr√®s bien ! Cette solution favorise l'entraide et l'inclusion."
                    }
                ]
            },
            {
                name: "Th√©o",
                age: "10 ans", 
                avatar: "üë¶",
                situation: "Th√©o, 10 ans, a un TDAH. Pendant un exercice de math√©matiques de 30 minutes, il montre des signes d'agitation. Quelle(s) strat√©gie(s) adoptez-vous ?",
                choices: [
                    {
                        text: "Lui demander de se calmer et de se concentrer davantage",
                        correct: false,
                        feedback: "Le TDAH n'est pas un manque de volont√©. Cette approche est inefficace et culpabilisante."
                    },
                    {
                        text: "D√©couper l'exercice en 3 s√©quences de 10 minutes avec des micro-pauses actives",
                        correct: true,
                        feedback: "Parfait ! Le d√©coupage et les pauses actives aident √† maintenir l'attention."
                    },
                    {
                        text: "L'isoler du groupe pour qu'il ne d√©range pas les autres",
                        correct: false,
                        feedback: "L'isolement peut stigmatiser et n'aide pas √† d√©velopper les comp√©tences sociales."
                    },
                    {
                        text: "Lui permettre d'utiliser un fidget ou un coussin d'√©quilibre pendant le travail",
                        correct: true,
                        feedback: "Excellente id√©e ! Ces outils peuvent aider √† canaliser l'hyperactivit√©."
                    }
                ]
            },
            {
                name: "L√©a",
                age: "11 ans",
                avatar: "üëß",
                situation: "L√©a, 11 ans, pr√©sente un TSA. C'est la rentr√©e et elle doit s'adapter √† un nouvel emploi du temps. Comment facilitez-vous cette transition ?",
                choices: [
                    {
                        text: "Lui expliquer que les changements font partie de la vie et qu'elle doit s'adapter",
                        correct: false,
                        feedback: "Cette approche ne tient pas compte des besoins sp√©cifiques li√©s au TSA."
                    },
                    {
                        text: "Cr√©er un emploi du temps visuel avec des pictogrammes et le lui pr√©senter avant la rentr√©e",
                        correct: true,
                        feedback: "Excellent ! La pr√©visibilit√© et les supports visuels sont essentiels pour les √©l√®ves TSA."
                    },
                    {
                        text: "Attendre le jour de la rentr√©e pour lui expliquer le nouvel emploi du temps",
                        correct: false,
                        feedback: "Les changements soudains peuvent √™tre tr√®s anxiog√®nes pour un √©l√®ve TSA."
                    },
                    {
                        text: "Organiser une visite de l'√©cole avant la rentr√©e avec pr√©sentation des nouveaux espaces",
                        correct: true,
                        feedback: "Tr√®s bien ! L'anticipation et la familiarisation r√©duisent l'anxi√©t√©."
                    }
                ]
            },
            {
                name: "Mathis",
                age: "9 ans",
                avatar: "üë¶",
                situation: "Mathis, 9 ans, a une dyspraxie. La classe doit r√©aliser une activit√© de d√©coupage et collage. Comment adaptez-vous l'activit√© ?",
                choices: [
                    {
                        text: "Lui donner les m√™mes ciseaux que les autres pour qu'il s'entra√Æne",
                        correct: false,
                        feedback: "Sans adaptation, l'activit√© risque d'√™tre frustrante et d√©courageante."
                    },
                    {
                        text: "Faire l'activit√© √† sa place pour lui √©viter la frustration",
                        correct: false,
                        feedback: "Faire √† la place de l'√©l√®ve ne d√©veloppe pas son autonomie."
                    },
                    {
                        text: "Proposer des ciseaux adapt√©s et des formes pr√©-d√©coup√©es qu'il peut finaliser",
                        correct: true,
                        feedback: "Parfait ! Cette adaptation permet √† Mathis de participer tout en respectant ses capacit√©s."
                    },
                    {
                        text: "Autoriser l'utilisation de gommettes ou d'√©l√©ments pr√©-d√©coup√©s comme alternative",
                        correct: true,
                        feedback: "Excellente alternative ! L'important est d'atteindre l'objectif p√©dagogique, pas la m√©thode."
                    }
                ]
            },
            {
                name: "Sarah",
                age: "12 ans",
                avatar: "üëß",
                situation: "Sarah, 12 ans, a une d√©ficience intellectuelle l√©g√®re. La classe travaille sur un projet de recherche. Comment l'incluez-vous efficacement ?",
                choices: [
                    {
                        text: "Lui donner un projet diff√©rent et plus simple √† faire seule",
                        correct: false,
                        feedback: "Cette approche isole Sarah du groupe et limite les interactions sociales."
                    },
                    {
                        text: "L'int√©grer √† un groupe en d√©finissant un r√¥le adapt√© (illustratrice, recherche d'images...)",
                        correct: true,
                        feedback: "Excellent ! Chacun contribue selon ses capacit√©s dans un projet commun."
                    },
                    {
                        text: "Demander aux autres √©l√®ves de faire le travail pour elle",
                        correct: false,
                        feedback: "Cette approche ne valorise pas les capacit√©s de Sarah et peut cr√©er du ressentiment."
                    },
                    {
                        text: "Adapter les objectifs d'apprentissage tout en maintenant sa participation au groupe",
                        correct: true,
                        feedback: "Tr√®s bien ! L'adaptation des objectifs permet une vraie inclusion."
                    }
                ]
            }
        ];

        // Sc√©narios Caf√© des Parents
        const cafeScenarios = [
            {
                speaker: "Parent inquiet",
                avatar: "üë§",
                question: "Mon enfant va avoir un √©l√®ve autiste dans sa classe. J'ai peur que cela perturbe son apprentissage...",
                responses: [
                    {
                        text: "Je comprends vos inqui√©tudes. Saviez-vous que la pr√©sence d'√©l√®ves avec TSA peut enrichir l'exp√©rience de tous ? Les √©l√®ves d√©veloppent plus d'empathie et de comp√©tences sociales.",
                        correct: true,
                        feedback: "Excellente r√©ponse ! Vous transformez l'inqui√©tude en opportunit√© d'apprentissage."
                    },
                    {
                        text: "Ne vous inqui√©tez pas, l'√©l√®ve autiste sera probablement isol√© du groupe pour ne pas d√©ranger.",
                        correct: false,
                        feedback: "Cette r√©ponse renforce la stigmatisation. L'inclusion b√©n√©ficie √† tous."
                    },
                    {
                        text: "Les adaptations mises en place b√©n√©ficient souvent √† tous les √©l√®ves. Un environnement structur√© et pr√©visible aide chacun √† mieux apprendre.",
                        correct: true,
                        feedback: "Tr√®s bien ! Vous montrez que l'inclusion est un atout pour tous."
                    },
                    {
                        text: "C'est vrai que c'est compliqu√©, mais on n'a pas le choix avec la loi sur l'inclusion.",
                        correct: false,
                        feedback: "Cette approche d√©fensive ne favorise pas l'adh√©sion. Il vaut mieux mettre en avant les b√©n√©fices."
                    }
                ]
            },
            {
                speaker: "Maman pr√©occup√©e",
                avatar: "üë©",
                question: "Mon fils est dyslexique et il rentre en CE2. J'ai peur qu'il prenne du retard par rapport aux autres...",
                responses: [
                    {
                        text: "La dyslexie n'est pas un frein √† la r√©ussite. Avec les bonnes adaptations, votre fils peut progresser √† son rythme tout en atteignant les objectifs.",
                        correct: true,
                        feedback: "R√©ponse rassurante et constructive qui valorise le potentiel de l'enfant."
                    },
                    {
                        text: "Il faudra accepter qu'il ait des difficult√©s et peut-√™tre envisager une orientation sp√©cialis√©e.",
                        correct: false,
                        feedback: "Cette r√©ponse est d√©courageante et ne propose pas de solutions inclusives."
                    },
                    {
                        text: "Nous travaillerons ensemble pour mettre en place des outils adapt√©s : police sp√©ciale, temps suppl√©mentaire, oral privil√©gi√©. Votre fils a toutes ses chances !",
                        correct: true,
                        feedback: "Excellent ! Vous proposez des solutions concr√®tes et rassurez le parent."
                    },
                    {
                        text: "Beaucoup de dyslexiques r√©ussissent tr√®s bien, regardez Einstein !",
                        correct: false,
                        feedback: "Bien que positif, cet exemple cr√©e une pression. Chaque enfant a son propre parcours."
                    }
                ]
            },
            {
                speaker: "Papa sceptique",
                avatar: "üë®",
                question: "Le TDAH, c'est juste des enfants mal √©lev√©s, non ? De mon temps, on savait se tenir !",
                responses: [
                    {
                        text: "Le TDAH est un trouble neurologique reconnu, pas un probl√®me d'√©ducation. Le cerveau traite l'information diff√©remment, ce qui affecte l'attention et l'impulsivit√©.",
                        correct: true,
                        feedback: "R√©ponse √©ducative qui informe sans juger les pr√©conceptions du parent."
                    },
                    {
                        text: "Vous avez tort ! C'est un vrai trouble et ce n'est pas la faute des parents !",
                        correct: false,
                        feedback: "Cette r√©ponse confrontante risque de braquer le parent au lieu de l'√©duquer."
                    },
                    {
                        text: "Je comprends votre point de vue. Les recherches en neurosciences nous montrent aujourd'hui que c'est plus complexe. Voulez-vous que je vous explique ?",
                        correct: true,
                        feedback: "Parfait ! Vous validez son ressenti tout en ouvrant la porte √† l'√©ducation."
                    },
                    {
                        text: "C'est vrai que certains enfants sont juste agit√©s, mais le TDAH c'est diff√©rent.",
                        correct: false,
                        feedback: "Cette r√©ponse ambigu√´ peut renforcer les pr√©jug√©s au lieu de les d√©construire."
                    }
                ]
            }
        ];

        // Questions Quiz Rapide
        const quizQuestions = [
            {
                question: "Quel trouble se caract√©rise par des difficult√©s de coordination motrice ?",
                options: ["TDAH", "Dyspraxie", "Dyslexie", "TSA"],
                correct: 1
            },
            {
                question: "Que signifie TSA ?",
                options: ["Trouble S√©v√®re de l'Attention", "Trouble du Spectre de l'Autisme", "Trouble Sensoriel Aigu", "Trouble Social Adaptatif"],
                correct: 1
            },
            {
                question: "Quel outil peut aider un √©l√®ve TDAH √† rester concentr√© ?",
                options: ["Un livre", "Un coussin d'√©quilibre", "Des lunettes", "Un stylo sp√©cial"],
                correct: 1
            },
            {
                question: "La dyslexie affecte principalement :",
                options: ["La motricit√©", "La lecture", "L'audition", "Le comportement"],
                correct: 1
            },
            {
                question: "Pour un √©l√®ve avec TSA, il est important de :",
                options: ["Changer souvent les routines", "Maintenir un environnement pr√©visible", "√âviter les supports visuels", "L'isoler des autres"],
                correct: 1
            }
        ];

        // Donn√©es des troubles
        const roomData = {
            tsa: {
                title: "Trouble du Spectre de l'Autisme (TSA)",
                content: `
                    <h4>Qu'est-ce que le TSA ?</h4>
                    <p>Le TSA se caract√©rise par des particularit√©s dans la communication sociale 
                    et des comportements r√©p√©titifs ou int√©r√™ts restreints.</p>
                    
                    <h4>Signes √† observer :</h4>
                    <ul>
                        <li>Difficult√©s dans les interactions sociales</li>
                        <li>Particularit√©s sensorielles (hyper ou hyposensibilit√©)</li>
                        <li>Besoin de routines et pr√©visibilit√©</li>
                        <li>Int√©r√™ts sp√©cifiques intenses</li>
                    </ul>
                    
                    <h4>Adaptations possibles :</h4>
                    <ul>
                        <li>Structurer l'environnement et le temps</li>
                        <li>Utiliser des supports visuels</li>
                        <li>Respecter les besoins sensoriels</li>
                        <li>Valoriser les int√©r√™ts sp√©cifiques</li>
                    </ul>
                    
                    <h4>üí° Astuce inclusive :</h4>
                    <p><em>Les √©l√®ves avec TSA ont souvent des comp√©tences exceptionnelles dans leurs domaines d'int√©r√™t. Utilisez ces passions comme levier d'apprentissage !</em></p>
                `
            },
            tdah: {
                title: "Trouble D√©ficit de l'Attention avec/sans Hyperactivit√© (TDAH)",
                content: `
                    <h4>Qu'est-ce que le TDAH ?</h4>
                    <p>Le TDAH se manifeste par des difficult√©s d'attention, une hyperactivit√© 
                    et/ou une impulsivit√© qui impactent le quotidien.</p>
                    
                    <h4>Signes √† observer :</h4>
                    <ul>
                        <li>Difficult√© √† maintenir l'attention</li>
                        <li>Agitation motrice fr√©quente</li>
                        <li>Impulsivit√© dans les actions et paroles</li>
                        <li>Organisation difficile</li>
                    </ul>
                    
                    <h4>Adaptations possibles :</h4>
                    <ul>
                        <li>D√©couper les t√¢ches en √©tapes courtes</li>
                        <li>Permettre des pauses actives</li>
                        <li>Utiliser des outils d'organisation (timer, planning)</li>
                        <li>Placer l'√©l√®ve loin des distractions</li>
                    </ul>
                    
                    <h4>üí° Astuce inclusive :</h4>
                    <p><em>Le mouvement aide √† la concentration ! Autorisez l'utilisation de balles anti-stress ou de coussins d'√©quilibre.</em></p>
                `
            },
            dys: {
                title: "Les Troubles DYS",
                content: `
                    <h4>Que sont les troubles DYS ?</h4>
                    <p>Les troubles DYS regroupent la dyslexie, dyspraxie, dyscalculie, 
                    dysorthographie, dysgraphie et dysphasie.</p>
                    
                    <h4>Manifestations principales :</h4>
                    <ul>
                        <li><strong>Dyslexie :</strong> Difficult√©s de lecture</li>
                        <li><strong>Dyspraxie :</strong> Troubles de la coordination</li>
                        <li><strong>Dyscalculie :</strong> Difficult√©s en math√©matiques</li>
                        <li><strong>Dysorthographie :</strong> Troubles de l'orthographe</li>
                        <li><strong>Dysgraphie :</strong> Difficult√©s d'√©criture</li>
                        <li><strong>Dysphasie :</strong> Troubles du langage oral</li>
                    </ul>
                    
                    <h4>Adaptations possibles :</h4>
                    <ul>
                        <li>Adapter les supports (police, interligne)</li>
                        <li>Autoriser les outils compensatoires</li>
                        <li>R√©duire la quantit√© d'√©crit</li>
                        <li>Privil√©gier l'oral pour l'√©valuation</li>
                    </ul>
                    
                    <h4>üí° Astuce inclusive :</h4>
                    <p><em>La police OpenDyslexic et un interligne de 1.5 peuvent faire une grande diff√©rence !</em></p>
                `
            },
            di: {
                title: "D√©ficience Intellectuelle",
                content: `
                    <h4>Qu'est-ce que la d√©ficience intellectuelle ?</h4>
                    <p>Elle se caract√©rise par des limitations significatives du fonctionnement 
                    intellectuel et du comportement adaptatif.</p>
                    
                    <h4>Points d'attention :</h4>
                    <ul>
                        <li>Rythme d'apprentissage diff√©rent</li>
                        <li>Besoin de r√©p√©tition et consolidation</li>
                        <li>Importance du concret et de la manipulation</li>
                        <li>D√©veloppement de l'autonomie</li>
                    </ul>
                    
                    <h4>Adaptations possibles :</h4>
                    <ul>
                        <li>Simplifier les consignes</li>
                        <li>Utiliser des supports visuels</li>
                        <li>Proposer des activit√©s concr√®tes</li>
                        <li>Adapter les objectifs d'apprentissage</li>
                    </ul>
                    
                    <h4>üí° Astuce inclusive :</h4>
                    <p><em>Valorisez chaque progr√®s, m√™me petit. La confiance en soi est essentielle pour apprendre !</em></p>
                `
            },
            moteur: {
                title: "Troubles du D√©veloppement Moteur",
                content: `
                    <h4>Que sont les troubles moteurs ?</h4>
                    <p>Ils incluent les troubles de la coordination motrice, les paralysies 
                    c√©r√©brales et autres atteintes motrices.</p>
                    
                    <h4>Impacts possibles :</h4>
                    <ul>
                        <li>Difficult√©s de d√©placement</li>
                        <li>Troubles de la motricit√© fine</li>
                        <li>Fatigabilit√© accrue</li>
                        <li>Besoin d'aides techniques</li>
                    </ul>
                    
                    <h4>Adaptations possibles :</h4>
                    <ul>
                        <li>Am√©nager l'espace physique</li>
                        <li>Adapter le mat√©riel scolaire</li>
                        <li>Permettre l'utilisation d'outils num√©riques</li>
                        <li>Pr√©voir des temps de repos</li>
                    </ul>
                    
                    <h4>üí° Astuce inclusive :</h4>
                    <p><em>L'accessibilit√© physique b√©n√©ficie √† tous : parents avec poussettes, √©l√®ves bless√©s temporairement...</em></p>
                `
            },
            communication: {
                title: "Troubles de la Communication",
                content: `
                    <h4>Que sont les troubles de la communication ?</h4>
                    <p>Ils regroupent les difficult√©s de langage oral, de compr√©hension et d'expression.</p>
                    
                    <h4>Manifestations :</h4>
                    <ul>
                        <li>Retard de langage</li>
                        <li>Difficult√©s de prononciation</li>
                        <li>Troubles de la compr√©hension</li>
                        <li>Communication non-verbale</li>
                    </ul>
                    
                    <h4>Adaptations possibles :</h4>
                    <ul>
                        <li>Utiliser la Communication Alternative et Augment√©e (CAA)</li>
                        <li>Supports visuels et gestuels</li>
                        <li>Temps suppl√©mentaire pour s'exprimer</li>
                        <li>Reformulation et v√©rification de la compr√©hension</li>
                    </ul>
                    
                    <h4>üí° Astuce inclusive :</h4>
                    <p><em>Les pictogrammes et les gestes peuvent aider tous les √©l√®ves √† mieux comprendre !</em></p>
                `
            }
        };

        // Fonctions du jeu
        function startGame() {
            loadProgress();
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('quickQuiz').style.display = 'none';
            document.getElementById('navbar').style.display = 'block';
            document.getElementById('moduleGrid').style.display = 'grid';
            if (score === 0) {
                updateScore(50);
                showNotification('üéÆ Bienvenue dans le Parcours TND !', 'info');
            }
        }

        function showDashboard() {
            hideAllSections();
            document.getElementById('dashboard').style.display = 'block';
            updateDashboardStats();
        }

        function updateDashboardStats() {
            document.getElementById('totalScore').textContent = score;
            document.getElementById('modulesCompleted').textContent = completedModules.length + '/4';
            document.getElementById('badgesUnlocked').textContent = unlockedBadges.length + '/5';
            
            const timeSpent = Math.floor((Date.now() - gameStartTime) / 1000 / 60);
            document.getElementById('timeSpent').textContent = timeSpent < 60 ? timeSpent + 'min' : Math.floor(timeSpent / 60) + 'h';
            
            // Afficher les accomplissements
            const achievementsList = document.getElementById('achievementsList');
            achievementsList.innerHTML = '';
            
            const achievements = [
                { icon: 'üè†', title: 'Explorateur', desc: 'Visitez toutes les pi√®ces de la maison', unlocked: roomsVisited.length >= 6 },
                { icon: 'üéí', title: 'P√©dagogue inclusif', desc: 'Compl√©tez tous les sc√©narios scolaires', unlocked: completedModules.includes('openAdaptationGame') },
                { icon: '‚òï', title: 'M√©diateur', desc: 'Participez au Caf√© des Parents', unlocked: completedModules.includes('openCafeGame') },
                { icon: 'üõ†Ô∏è', title: 'Bricoleur inclusif', desc: 'D√©couvrez tous les outils', unlocked: toolsDiscovered.length >= 4 },
                { icon: 'üèÜ', title: 'Expert TND', desc: 'Atteignez le niveau 5', unlocked: level >= 5 }
            ];
            
            achievements.forEach(ach => {
                const div = document.createElement('div');
                div.className = 'achievement' + (ach.unlocked ? '' : ' locked');
                div.innerHTML = `
                    <div class="achievement-icon">${ach.icon}</div>
                    <div class="achievement-info">
                        <h4>${ach.title}</h4>
                        <p>${ach.desc}</p>
                    </div>
                `;
                achievementsList.appendChild(div);
            });
        }

        function showResources() {
            hideAllSections();
            document.getElementById('resources').style.display = 'block';
        }

        function showResourceTab(tab) {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            const content = document.getElementById('resourcesContent');
            content.innerHTML = '';
            
            const resources = {
                guides: [
                    { title: 'Guide de l\'inclusion scolaire', desc: 'Document complet sur les adaptations p√©dagogiques' },
                    { title: 'Fiches pratiques TSA', desc: '10 fiches d\'adaptation pour les √©l√®ves avec TSA' },
                    { title: 'Bo√Æte √† outils TDAH', desc: 'Strat√©gies et outils pour accompagner les √©l√®ves TDAH' }
                ],
                videos: [
                    { title: 'Comprendre les TND', desc: 'Vid√©o de 15 minutes sur les troubles du neurod√©veloppement' },
                    { title: 'T√©moignages d\'inclusion', desc: 'Parents et enseignants partagent leurs exp√©riences' },
                    { title: 'Am√©nagements en classe', desc: 'Exemples concrets d\'adaptations r√©ussies' }
                ],
                outils: [
                    { title: 'G√©n√©rateur de pictogrammes', desc: 'Cr√©ez vos supports visuels personnalis√©s' },
                    { title: 'Timer visuel', desc: 'Application pour structurer le temps' },
                    { title: 'Police OpenDyslexic', desc: 'Police adapt√©e pour les √©l√®ves dyslexiques' }
                ],
                liens: [
                    { title: 'Site du Minist√®re', desc: 'Ressources officielles sur l\'√©cole inclusive' },
                    { title: 'Association TND', desc: 'Informations et soutien aux familles' },
                    { title: 'Forum enseignants', desc: '√âchangez avec d\'autres professionnels' }
                ]
            };
            
            resources[tab].forEach(res => {
                const div = document.createElement('div');
                div.className = 'resource-item';
                div.innerHTML = `
                    <div class="resource-info">
                        <h4>${res.title}</h4>
                        <p>${res.desc}</p>
                    </div>
                    <button class="download-btn" onclick="downloadResource('${res.title}')">
                        ${tab === 'liens' ? 'üîó Visiter' : 'üì• T√©l√©charger'}
                    </button>
                `;
                content.appendChild(div);
            });
        }

        function downloadResource(resource) {
            showNotification(`üì• T√©l√©chargement de "${resource}" simul√©`, 'success');
            updateScore(10);
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            event.target.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            showNotification(isDark ? 'üåô Mode sombre activ√©' : '‚òÄÔ∏è Mode clair activ√©', 'info');
        }

        function hideAllSections() {
            const sections = ['moduleGrid', 'houseGame', 'adaptationGame', 'cafeGame', 'workshopGame', 'dashboard', 'resources', 'quickQuiz'];
            sections.forEach(id => {
                document.getElementById(id).style.display = 'none';
            });
        }

        function openHouseGame() {
            hideAllSections();
            document.getElementById('houseGame').style.display = 'block';
        }

        function openAdaptationGame() {
            hideAllSections();
            document.getElementById('adaptationGame').style.display = 'block';
            currentScenarioIndex = 0;
            scenariosCompleted = 0;
            correctAnswersCount = 0;
            loadScenario(0);
            startScenarioTimer();
        }

        function openCafeGame() {
            hideAllSections();
            document.getElementById('cafeGame').style.display = 'block';
            cafeScenarioIndex = 0;
            loadCafeScenario();
        }

        function openWorkshop() {
            hideAllSections();
            document.getElementById('workshopGame').style.display = 'block';
        }

        function toggleToolDetails(element) {
            const details = element.querySelector('.tool-details');
            const isVisible = details.style.display === 'block';
            
            // Fermer tous les autres d√©tails
            document.querySelectorAll('.tool-details').forEach(d => {
                d.style.display = 'none';
            });
            
            details.style.display = isVisible ? 'none' : 'block';
            
            if (!isVisible) {
                const toolName = element.querySelector('h4').textContent;
                if (!toolsDiscovered.includes(toolName)) {
                    toolsDiscovered.push(toolName);
                    updateScore(50);
                    
                    if (toolsDiscovered.length >= 4) {
                        document.getElementById('workshopProgress').style.width = '100%';
                        if (!completedModules.includes('openWorkshop')) {
                            completedModules.push('openWorkshop');
                            showNotification('üéâ Module Atelier compl√©t√© !', 'success');
                            unlockBadge('badge5');
                        }
                    } else {
                        document.getElementById('workshopProgress').style.width = (toolsDiscovered.length / 4 * 100) + '%';
                    }
                    
                    saveProgress();
                }
            }
        }

        function loadCafeScenario() {
            if (cafeScenarioIndex >= cafeScenarios.length) {
                completeCafeModule();
                return;
            }
            
            const scenario = cafeScenarios[cafeScenarioIndex];
            document.getElementById('speakerName').textContent = scenario.speaker;
            document.querySelector('.speaker-avatar').textContent = scenario.avatar;
            document.getElementById('parentQuestion').textContent = scenario.question;
            
            const responseOptions = document.getElementById('responseOptions');
            responseOptions.innerHTML = '';
            
            scenario.responses.forEach((response, i) => {
                const div = document.createElement('div');
                div.className = 'choice';
                div.innerHTML = response.text;
                div.onclick = function() { handleParentResponse(this, response.correct, response.feedback); };
                responseOptions.appendChild(div);
            });
            
            document.getElementById('cafeFeedback').style.display = 'none';
        }

        function handleParentResponse(element, isCorrect, feedback) {
            const choices = document.querySelectorAll('#responseOptions .choice');
            choices.forEach(c => c.classList.add('disabled'));
            
            if (isCorrect) {
                element.classList.add('correct');
                updateScore(200);
                showCafeFeedback(true, feedback);
            } else {
                element.classList.add('incorrect');
                showCafeFeedback(false, feedback);
            }
            
            setTimeout(() => {
                cafeScenarioIndex++;
                if (cafeScenarioIndex < cafeScenarios.length) {
                    setTimeout(() => {
                        choices.forEach(c => {
                            c.classList.remove('correct', 'incorrect', 'disabled');
                        });
                        loadCafeScenario();
                    }, 1000);
                } else {
                    completeCafeModule();
                }
            }, 2500);
        }

        function completeCafeModule() {
            document.getElementById('cafeProgress').style.width = '100%';
            
            if (!completedModules.includes('openCafeGame')) {
                completedModules.push('openCafeGame');
                
                if (!unlockedBadges.includes('badge4')) {
                    unlockBadge('badge4');
                    showNotification('üéâ Badge d√©bloqu√© : Innovateur p√©dagogique !', 'success');
                }
                
                showCafeFeedback(true, 'üèÜ F√©licitations ! Vous avez brillamment g√©r√© toutes les conversations. Vous √™tes un ambassadeur de l\'inclusion !');
                
                setTimeout(() => {
                    backToModules();
                }, 4000);
            }
            
            saveProgress();
        }

        function startScenarioTimer() {
            let seconds = 0;
            const timerElement = document.getElementById('scenarioTimer');
            
            if (window.scenarioTimer) clearInterval(window.scenarioTimer);
            
            window.scenarioTimer = setInterval(() => {
                seconds++;
                const minutes = Math.floor(seconds / 60);
                const secs = seconds % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function loadScenario(index) {
            answeredCurrentQuestion = false;
            const scenario = scenarios[index];
            
            // Mettre √† jour les infos du personnage
            document.getElementById('characterName').textContent = scenario.name;
            document.getElementById('characterAge').textContent = scenario.age;
            document.querySelector('.character-avatar').textContent = scenario.avatar;
            
            document.getElementById('currentScenario').textContent = index + 1;
            document.getElementById('scenarioProgress').style.width = ((index + 1) / scenarios.length * 100) + '%';
            
            // Animation de transition
            const scenarioBox = document.getElementById('scenarioBox');
            scenarioBox.style.animation = 'none';
            setTimeout(() => {
                scenarioBox.style.animation = 'slideIn 0.5s ease-out';
                document.getElementById('scenarioText').textContent = scenario.situation;
            }, 10);
            
            // Charger les choix
            const choicesContainer = document.getElementById('choicesContainer');
            choicesContainer.innerHTML = '';
            
            scenario.choices.forEach((choice, i) => {
                const choiceDiv = document.createElement('div');
                choiceDiv.className = 'choice';
                choiceDiv.setAttribute('data-index', i);
                choiceDiv.innerHTML = `<strong>Option ${String.fromCharCode(65 + i)} :</strong> ${choice.text}`;
                choiceDiv.onclick = function() { 
                    if (!answeredCurrentQuestion) {
                        checkAnswer(this, choice.correct, choice.feedback);
                    }
                };
                choicesContainer.appendChild(choiceDiv);
            });
            
            // R√©initialiser le feedback et le bouton
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('nextScenarioBtn').style.display = 'none';
        }

        function backToModules() {
            hideAllSections();
            document.getElementById('moduleGrid').style.display = 'grid';
            
            // R√©initialiser les feedbacks
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('cafeFeedback').style.display = 'none';
            
            // Arr√™ter le timer
            if (window.scenarioTimer) {
                clearInterval(window.scenarioTimer);
                document.getElementById('scenarioTimer').textContent = '--:--';
            }
            
            saveProgress();
        }

        function showRoomInfo(room) {
            currentRoom = room;
            const data = roomData[room];
            document.getElementById('popupTitle').textContent = data.title;
            document.getElementById('popupContent').innerHTML = data.content;
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('infoPopup').style.display = 'block';
            
            // S'assurer que les boutons sont corrects
            const actionButtons = document.querySelector('.action-buttons');
            actionButtons.innerHTML = `
                <button class="btn btn-primary" onclick="completeRoom()">J'ai compris !</button>
                <button class="btn btn-secondary" onclick="closePopup()">Fermer</button>
            `;
        }

        function closePopup() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('infoPopup').style.display = 'none';
        }

        function completeRoom() {
            if (!roomsVisited.includes(currentRoom)) {
                roomsVisited.push(currentRoom);
                updateScore(100);
                
                // Marquer la pi√®ce comme visit√©e
                document.getElementById('room-' + currentRoom).classList.add('visited');
                
                // Mettre √† jour la progression
                const progress = (roomsVisited.length / 6) * 100;
                document.getElementById('houseProgress').style.width = progress + '%';
                
                // Retirer l'indicateur de nouvelle info
                const infoIcon = document.getElementById('info-' + currentRoom);
                if (infoIcon) infoIcon.style.display = 'none';
                
                // D√©bloquer badge et compl√©ter module si toutes les pi√®ces visit√©es
                if (roomsVisited.length === 6) {
                    if (!completedModules.includes('openHouseGame')) {
                        completedModules.push('openHouseGame');
                        unlockBadge('badge1');
                        showNotification('üéâ Badge d√©bloqu√© : Observateur attentif !', 'success');
                        showNotification('üè† Module Maison des D√©couvertes compl√©t√© !', 'success');
                    }
                }
                
                saveProgress();
            }
            closePopup();
        }

        function checkAnswer(element, isCorrect, feedbackText) {
            if (answeredCurrentQuestion) return;
            
            answeredCurrentQuestion = true;
            
            // D√©sactiver tous les choix
            const choices = document.querySelectorAll('.choice');
            choices.forEach(c => {
                c.classList.add('disabled');
            });
            
            // Marquer la r√©ponse s√©lectionn√©e
            if (isCorrect) {
                element.classList.add('correct');
                updateScore(150);
                correctAnswersCount++;
                showFeedback(true, "‚úì " + feedbackText);
            } else {
                element.classList.add('incorrect');
                showFeedback(false, "‚úó " + feedbackText);
            }
            
            // Montrer toutes les bonnes r√©ponses apr√®s un d√©lai
            setTimeout(() => {
                const scenario = scenarios[currentScenarioIndex];
                const choiceElements = document.querySelectorAll('.choice');
                
                choiceElements.forEach((choiceElement) => {
                    const index = parseInt(choiceElement.getAttribute('data-index'));
                    if (scenario.choices[index].correct) {
                        choiceElement.classList.add('correct');
                    }
                });
                
                // Afficher le bouton suivant
                if (currentScenarioIndex < scenarios.length - 1) {
                    document.getElementById('nextScenarioBtn').style.display = 'inline-block';
                } else {
                    // Fin du module
                    setTimeout(() => {
                        completeSchoolModule();
                    }, 2000);
                }
            }, 1500);
        }

        function nextScenario() {
            // R√©initialiser les classes des choix
            const choices = document.querySelectorAll('.choice');
            choices.forEach(c => {
                c.classList.remove('correct', 'incorrect', 'disabled');
            });
            
            currentScenarioIndex++;
            loadScenario(currentScenarioIndex);
        }

        function completeSchoolModule() {
            updateSchoolProgress(100);
            
            if (!completedModules.includes('openAdaptationGame')) {
                completedModules.push('openAdaptationGame');
                
                if (!unlockedBadges.includes('badge3')) {
                    unlockBadge('badge3');
                    showNotification('üéâ Badge d√©bloqu√© : Architecte de l\'inclusion !', 'success');
                }
                if (!unlockedBadges.includes('badge2')) {
                    unlockBadge('badge2');
                    showNotification('üéâ Badge d√©bloqu√© : M√©diateur bienveillant !', 'success');
                }
            }
            
            // Message personnalis√© selon la performance
            let finalMessage = `üèÜ F√©licitations ! Vous avez termin√© tous les sc√©narios de l'√âcole Inclusive. `;
            if (correctAnswersCount === scenarios.length) {
                finalMessage += "Score parfait ! Vous √™tes un¬∑e expert¬∑e de l'inclusion !";
                updateScore(500); // Bonus pour score parfait
            } else if (correctAnswersCount >= scenarios.length * 0.7) {
                finalMessage += "Excellent travail ! Vous ma√Ætrisez les principes de l'inclusion.";
            } else {
                finalMessage += "Bon d√©but ! Continuez √† pratiquer pour devenir expert¬∑e en inclusion.";
            }
            
            showFeedback(true, finalMessage);
            
            // Arr√™ter le timer
            if (window.scenarioTimer) {
                clearInterval(window.scenarioTimer);
            }
            
            setTimeout(() => {
                correctAnswersCount = 0; // R√©initialiser pour la prochaine fois
                backToModules();
            }, 5000);
            
            saveProgress();
        }

        function showFeedback(isSuccess, message) {
            const feedback = document.getElementById('feedback');
            feedback.className = 'feedback ' + (isSuccess ? 'success' : 'error');
            feedback.textContent = message;
            feedback.style.display = 'block';
        }

        function showCafeFeedback(isSuccess, message) {
            const feedback = document.getElementById('cafeFeedback');
            feedback.className = 'feedback ' + (isSuccess ? 'success' : 'error');
            feedback.textContent = message;
            feedback.style.display = 'block';
        }

        function updateScore(points) {
            score += points;
            document.getElementById('score').textContent = score;
            
            // V√©rifier le niveau
            const newLevel = Math.floor(score / 1000) + 1;
            if (newLevel > level) {
                level = newLevel;
                document.getElementById('playerLevel').textContent = level;
                showNotification(`üéâ Niveau ${level} atteint !`, 'success');
                
                if (level >= 5 && !unlockedBadges.includes('badge5')) {
                    unlockBadge('badge5');
                    showNotification('üèÜ Badge ultime d√©bloqu√© : Expert en inclusion !', 'success');
                }
            }
            
            // Animation du score
            const scoreElement = document.querySelector('.score');
            scoreElement.style.transform = 'scale(1.2)';
            setTimeout(() => {
                scoreElement.style.transform = 'scale(1)';
            }, 300);
            
            saveProgress();
        }

        function updateSchoolProgress(percent = null) {
            if (percent) {
                document.getElementById('schoolProgress').style.width = percent + '%';
            } else {
                const progress = ((currentScenarioIndex + 1) / scenarios.length) * 100;
                document.getElementById('schoolProgress').style.width = progress + '%';
            }
        }

        function unlockBadge(badgeId) {
            const badge = document.getElementById(badgeId);
            badge.classList.add('unlocked');
            if (!unlockedBadges.includes(badgeId)) {
                unlockedBadges.push(badgeId);
            }
            saveProgress();
        }

        function showNotification(message, type = 'info') {
            // Cr√©er une notification temporaire
            const notif = document.createElement('div');
            notif.className = `notification ${type}`;
            notif.innerHTML = `
                <span style="font-size: 1.5em;">${type === 'success' ? '‚úì' : '‚ÑπÔ∏è'}</span>
                <span>${message}</span>
            `;
            document.body.appendChild(notif);
            
            setTimeout(() => {
                notif.style.opacity = '0';
                setTimeout(() => notif.remove(), 500);
            }, 3000);
        }

        // Quiz rapide
        function showQuickQuiz() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('quickQuiz').style.display = 'block';
            quizCurrentQuestion = 0;
            quizScore = 0;
            loadQuizQuestion();
            startQuizTimer();
        }

        function loadQuizQuestion() {
            if (quizCurrentQuestion >= quizQuestions.length) {
                endQuiz();
                return;
            }
            
            const question = quizQuestions[quizCurrentQuestion];
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, i) => {
                const div = document.createElement('div');
                div.className = 'quiz-option';
                div.textContent = option;
                div.onclick = function() { checkQuizAnswer(this, i === question.correct); };
                optionsContainer.appendChild(div);
            });
        }

        function checkQuizAnswer(element, isCorrect) {
            const options = document.querySelectorAll('.quiz-option');
            options.forEach(o => o.onclick = null);
            
            if (isCorrect) {
                element.style.background = '#e8f5e9';
                element.style.borderColor = '#4caf50';
                quizScore++;
            } else {
                element.style.background = '#ffebee';
                element.style.borderColor = '#f44336';
            }
            
            setTimeout(() => {
                quizCurrentQuestion++;
                loadQuizQuestion();
            }, 1000);
        }

        function startQuizTimer() {
            let timeLeft = 30;
            const timerElement = document.getElementById('quizTimer');
            
            quizTimer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                
                if (timeLeft <= 10) {
                    timerElement.style.color = '#f44336';
                }
                
                if (timeLeft <= 0) {
                    endQuiz();
                }
            }, 1000);
        }

        function endQuiz() {
            clearInterval(quizTimer);
            document.getElementById('quizQuestion').style.display = 'none';
            document.getElementById('quizResults').style.display = 'block';
            
            document.getElementById('quizScore').textContent = quizScore + '/' + quizQuestions.length;
            
            let message = '';
            if (quizScore === quizQuestions.length) {
                message = 'Parfait ! Vous √™tes un expert des TND !';
                updateScore(200);
            } else if (quizScore >= quizQuestions.length * 0.7) {
                message = 'Tr√®s bien ! Vous avez de bonnes connaissances.';
                updateScore(100);
            } else {
                message = 'Continuez √† apprendre, vous progressez !';
                updateScore(50);
            }
            
            document.getElementById('quizMessage').textContent = message;
        }

        function restartQuiz() {
            document.getElementById('quizResults').style.display = 'none';
            document.getElementById('quizQuestion').style.display = 'block';
            document.getElementById('quizTimer').style.color = '#667eea';
            showQuickQuiz();
        }

        // Fonction pour afficher les infos de d√©veloppement
        function showDevInfo() {
            const devContent = `
                <h3>üéÆ √âtat du d√©veloppement - Parcours TND</h3>
                
                <h4>‚úÖ Ce qui a √©t√© impl√©ment√© :</h4>
                <ul>
                    <li><strong>4 modules jouables :</strong> Maison des D√©couvertes, √âcole Inclusive, Caf√© des Parents, Atelier des Solutions</li>
                    <li><strong>Syst√®me de progression :</strong> Sauvegarde locale, niveaux, score XP</li>
                    <li><strong>5 badges √† d√©bloquer :</strong> Chacun r√©compense un aspect de l'apprentissage</li>
                    <li><strong>Quiz rapide :</strong> Mode de jeu alternatif avec timer</li>
                    <li><strong>Tableau de bord :</strong> Statistiques et accomplissements</li>
                    <li><strong>Centre de ressources :</strong> Documents t√©l√©chargeables simul√©s</li>
                    <li><strong>Mode sombre :</strong> Pour le confort visuel</li>
                    <li><strong>6 troubles couverts :</strong> TSA, TDAH, DYS, DI, Moteurs, Communication</li>
                </ul>
                
                <h4>üîß Ce qu'on peut faire maintenant :</h4>
                <ul>
                    <li>Explorer tous les modules pour apprendre sur les TND</li>
                    <li>Gagner des badges et monter en niveau</li>
                    <li>Consulter les ressources p√©dagogiques</li>
                    <li>Tester ses connaissances avec le quiz</li>
                    <li>Sauvegarder sa progression et reprendre plus tard</li>
                </ul>
                
                <h4>üí° Ce qu'on pourrait ajouter :</h4>
                <ul>
                    <li><strong>Mode collaboratif :</strong> Permettre √† plusieurs formateurs de jouer ensemble</li>
                    <li><strong>Certificats :</strong> G√©n√©rer des attestations de formation</li>
                    <li><strong>D√©fis quotidiens :</strong> Nouveaux sc√©narios chaque jour</li>
                    <li><strong>Vid√©os int√©gr√©es :</strong> T√©moignages et tutoriels</li>
                    <li><strong>Forum communautaire :</strong> √âchanger entre formateurs</li>
                    <li><strong>Export PDF :</strong> Cr√©er des fiches pratiques personnalis√©es</li>
                    <li><strong>Mode hors-ligne :</strong> Application t√©l√©chargeable</li>
                    <li><strong>Personnalisation avatar :</strong> Cr√©er son personnage</li>
                    <li><strong>Statistiques d√©taill√©es :</strong> Graphiques de progression</li>
                    <li><strong>API backend :</strong> Pour synchroniser entre appareils</li>
                </ul>
                
                <h4>üìä Statistiques techniques :</h4>
                <ul>
                    <li>Plus de 2000 lignes de code</li>
                    <li>5 mini-jeux diff√©rents</li>
                    <li>30+ sc√©narios p√©dagogiques</li>
                    <li>Responsive design mobile/desktop</li>
                    <li>Aucune d√©pendance externe</li>
                </ul>
                
                <p style="margin-top: 20px; font-style: italic;">
                    Ce jeu s√©rieux a √©t√© con√ßu pour former les professionnels de l'√©ducation 
                    aux troubles du neurod√©veloppement de mani√®re ludique et engageante.
                </p>
            `;
            
            document.getElementById('popupTitle').textContent = 'Informations de d√©veloppement';
            document.getElementById('popupContent').innerHTML = devContent;
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('infoPopup').style.display = 'block';
            
            // Modifier les boutons pour cette popup sp√©ciale
            const actionButtons = document.querySelector('.action-buttons');
            actionButtons.innerHTML = '<button class="btn btn-primary" onclick="closePopup()">Fermer</button>';
        }

        // Initialisation
        window.onload = function() {
            // Charger la progression si elle existe
            if (localStorage.getItem('tndGameProgress')) {
                const savedData = JSON.parse(localStorage.getItem('tndGameProgress'));
                if (savedData.score > 0) {
                    // Proposer de continuer ou recommencer
                    const continueGame = confirm('Une partie sauvegard√©e a √©t√© trouv√©e. Voulez-vous continuer ?');
                    if (!continueGame) {
                        localStorage.removeItem('tndGameProgress');
                    }
                }
            }
        };
    </script>
</body>
</html>
